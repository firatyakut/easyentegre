{{ header }}{{ column_left }}
<div id="content">
    <div class="page-header">

        <div class="container-fluid">
            <ul class="breadcrumb">
                {% for breadcrumb in breadcrumbs %}
                    <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
                {% endfor %}
            </ul>
            <div class="{{  easy_visibility }} pull-right easy-mode ">
                <img src="view/image/entegrasyon/logo.png" />
            </div>
        </div>
    </div>
    <div class="container-fluid"> {% if success %}
            <div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> {{ success }}
                <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
        {% endif %}
        {% if error %}
            {% for error_message in error %}
                <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_message }}</div>
            {% endfor %}
        {% endif %}
        <div class="panel panel-default" style="border-top: 2px solid #27ad5e;">
            <div class="panel-heading">

                <div class="panel-body">

                    <div class="col-12 api_type_wrap pt-1"><div class="api_type_content api_type_1" data-api-type="1" data-step-no="5" style="display: block;">
                            <div class="row">
                                <div class="col-12">
                                    <h1 class="font-weight-bolder text-primary text-center">Extra Modül ve Eklentiler</h1>
                                    <h4 class="text-center">Lütfen kullanmak istediğiniz modülleri aktif edebilirsiniz.</h4>
                                </div>
                            </div>



                            <div class="row pr-5 pl-5 justify-content-center api_list_wrap well">

                                {% for module in modules %}
                                    <div style="height: 300px" aria-rowindex="" class="col-12 col-sm-6 col-md-2 col-lg-3 col-xl-2 mt-1 mb-1 {% if module.is_registered %} active {% else %} passive {% endif %}  ">
                                        {% if module.is_registered %} <i  class="fa fa-check fa-3x ontopleft"></i> {% endif %}
                                        <div style="border: 1px solid #ccc" class=" api_wrap rounded-lg border border-2 " data-api-code="{{ module.code }}">
                                            <img width="100%"  src="{{ module.image }}" class="img-fluid" alt="{{ module.name }}">
                                            <div class="api_hover rounded-lg">
                                                <div  class="api_connect text-center">

                                                    {% if module.is_registered %}
                                                        <div code="{{ module.code }}"  class="api_connect text-center">
                                                            <button code="{{ module.code }}" data-toggle="tooltip" title="{{ module.name }} Deaktif Et"   class="btn btn-default btnActive" action="0" data-loading-text="<i class='fa fa-spinner fa-spin '></i>"> <i class="fa  fa-power-off"></i></button>
                                                            <button code="{{ module.code }}" data-toggle="tooltip" title="{{ module.name }} Ayarları"   class="btn btn-default btnEdit" data-loading-text="<i class='fa fa-spinner fa-spin '></i>"> <i class="fa  fa-edit"></i></button>
                                                            <button code="{{ module.code }}" data-toggle="tooltip" title="{{ module.name }} api bilgilerinizi girin"   class="btn btn-default btnPazar" data-loading-text="<i class='fa fa-spinner fa-spin '></i> ..." > <i class="fa fa-wrench"></i></button>
                                                        </div>
                                                    {% else %}

                                                        <div code="{{ module.code }}" action="1" class="api_connect text-center btnActive">
                                                            <i   class="fa fa-cog "></i> Aktif Et
                                                        </div>
                                                    {% endif %}


                                                </div>
                                            </div>
                                        </div>
                                    </div>   {% endfor %}




                            </div></div>


                    </div>

                    <script>



                        $(document).on('click','.btnActive',function (event) {
                            var thisButton = $(this);
                            var code=thisButton.attr('code');
                            var action=thisButton.attr('action');

                            $.post('index.php?route=entegrasyon/module/module_active&{{ token_link }}',{code:code,action:action}, function (json) {
                               // thisButton.button('reset');
                                location.reload();

                                },'JSON');
                                })

                        $(document).on('click','.btnKaydet',function (event) {
                            var thisButton = $(this);



                            var code=thisButton.attr('id');
                            var name=thisButton.attr('name');
                            var data=$("form").serialize();
                            var error=false;

                            //  thisButton.button('loading');


                            if(!error) {

                                $.post('index.php?route=entegrasyon/module/api_setting&code='+code+'&{{ token_link }}',data, function (json) {
                                    thisButton.button('reset');
                                    if (json['status']) {


                                        Swal.fire({
                                            title: 'Başarılı',
                                            text: name+" Api bilgileriniz Doğrulandı, Ayarlar Sayfasına Dönmek İstermisiniz ?",
                                            icon: 'success',
                                            showCancelButton: true,
                                            confirmButtonColor: '#3085d6',
                                            cancelButtonColor: '#d33',
                                            confirmButtonText: "Evet",
                                            cancelButtonText: "Hayır!",
                                        }).then((result) => {
                                            if (result.value) {

                                                $('.btnVazgec').click();

                                            }
                                        });

                                        //$('#diger').removeClass('hidden');
                                    } else {

                                        Swal.fire('Başarısız',json['message'],'warning');



                                    }

                                }, 'JSON')

                            }

                        })

                    </script>



                 

                    <script>

                        $(document).on('click','.btnSave', function () {


                            var error=false;
                            var data =$('form').serializeArray();
                            var thisButton = $(this);
                            var code=thisButton.attr('id');
                            thisButton.button('loading');

                            if(!error) {

                                $.post('index.php?route=entegrasyon/module/default_setting&code='+code+'&{{ token_link }}', data, function (json) {
                                    thisButton.button('reset');
                                    if (json['status']) {


                                        Swal.fire({
                                            title: 'Başarılı',
                                            text:  "Ayarlar Kaydedildi. Anasayfaya dönmek ister misiniz?",
                                            icon: 'success',
                                            showCancelButton: true,
                                            confirmButtonColor: '#3085d6',
                                            cancelButtonColor: '#d33',
                                            confirmButtonText: 'Evet!',
                                            cancelButtonText: "Hayır!",

                                        }).then((result) => {
                                            if (result.value) {


                                                $('.btnVazgec').click();

                                            }
                                        })


                                    } else {

                                        Swal.fire('Başarız',json['message'],'warning');


                                    }

                                }, 'JSON')

                            }

                        })



                    </script>


                    <script>

                        $(document).on('click','.btnReset', function () {

                            var thisButton=$(this);
                            var code=thisButton.attr('id');
                            //var name=thisButton.attr('name');

                            Swal.fire({
                                title: 'Dikkat!',
                                text:  code+ "Api Bilgileriniz Silinecektir. Onaylıyormusunuz ?",
                                icon: 'warning',
                                showCancelButton: true,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Evet, Onaylıyorum!',
                                cancelButtonText: "Hayır!",

                            }).then((result) => {
                                if (result.value) {
                                    thisButton.button('loading');

                                    $.post('index.php?route=entegrasyon/module/reset&code='+code+'&{{ token_link }}', {}, function (json) {
                                        thisButton.button('reset');


                                        Swal.fire({
                                            title: 'Başarılı',
                                            text: name+" Api bilgileriniz Silinmiştir, Ayarlar Sayfasına Dönmek İstermisiniz ?",
                                            icon: 'info',
                                            showCancelButton: true,
                                            confirmButtonColor: '#3085d6',
                                            cancelButtonColor: '#d33',
                                            confirmButtonText: 'Evet!',
                                            cancelButtonText: "Hayır!",

                                        }).then((result) => {
                                            if (result.value) {


                                                $('.btnVazgec').click();

                                            }
                                        })
                                    }, 'JSON')
                                }
                            });


                        })

                    </script>




                    <script>

                        $(document).on('click','.btnEdit',function (event) {

                            var $thisBtn=$(this);
                            // $thisBtn.button('loading');
                            var $code= $thisBtn.attr('code');




                            BootstrapDialog.show({
                                title:'Api Ayarları',
                                draggable: true,
                                size: BootstrapDialog.SIZE_WIDE,

                                message: function(dialog) {
                                    var $message = $('<div></div>');
                                    var pageToLoad = dialog.getData('pageToLoad');
                                    $message.load(pageToLoad);
                                    return $message;
                                },
                                data: {
                                    'pageToLoad': 'index.php?route=entegrasyon/module/default_setting&code='+$code+'&{{ token_link }}'
                                },buttons: [ {
                                    id:$code,
                                    label: 'Kaydet',
                                    cssClass: 'btnSave btn-primary',
                                    action: function(dialogItself){

                                    }
                                },{
                                    label: 'Kapat',
                                    cssClass: ' btn-danger',
                                    action: function(dialogItself){
                                        dialogItself.close();
                                    }
                                }]
                            });


                        })

                    </script>


                    <script>

                        $(document).on('click','.btnPazar',function (event) {

                            var $thisBtn=$(this);
                            // $thisBtn.button('loading');
                            var $code= $thisBtn.attr('code');


                            BootstrapDialog.show({
                                title:'Api Ayarları',
                                closable: false,
                                draggable: true,
                                message: function(dialog) {
                                    var $message = $('<div></div>');
                                    var pageToLoad = dialog.getData('pageToLoad');
                                    $message.load(pageToLoad);
                                    return $message;
                                },
                                data: {
                                    'pageToLoad': 'index.php?route=entegrasyon/module/api_setting&code='+$code+'&{{ token_link }}'
                                },buttons: [ {
                                    id:$code,
                                    label: 'Kaydet',
                                    cssClass: 'btnKaydet btn-primary',
                                    action: function(dialogItself){

                                    }
                                },{
                                    id:$code,
                                    label: 'Sıfırla',
                                    cssClass: 'btnReset btn-warning',
                                    action: function(dialogItself){
                                    }
                                },{
                                    label: 'Kapat',
                                    cssClass: ' btn-danger',
                                    action: function(dialogItself){
                                        dialogItself.close();
                                    }
                                }]
                            });


                        })

                    </script>










                </div>

        </div>
    </div>








    {{ footer }}
